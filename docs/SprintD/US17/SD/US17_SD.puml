@startuml US17_SD
autonumber

actor "Center Coordinator" as COORDINATOR

participant ":ImportLegacyDataUI" as UI
participant ":App" as _APP
participant "app:App" as APP
participant ":ImportLegacyDataController" as CTRL
participant "comp:Company" as COMPANY
participant "snsUserStore:SNSUserStore" as SNSSTORE
participant "csvReader:CSVReader" as CSVREADER
participant ":ICSVReader" as ICSV
participant "vacStore:VaccinationCenterStore" as VACSTORE
participant ":LegacyDataImporter" as IMPORT

activate COORDINATOR
  ref over COORDINATOR
    ' !include ../../CoordinatorLogin_SD.puml!
    ' ![[../../CoordinatorLogin_SD.puml]]
    ' ![[../../CoordinatorLogin_SD.svg]]
    CoordinatorLogin_SD
  end ref

  COORDINATOR -> UI : wants to import legacy data
  activate UI

    UI -> _APP : app = getInstance()
    activate _APP
    deactivate _APP

    UI -> APP : company = getCompany()
    activate APP
    deactivate APP

    |||

    note right of UI
      <i><b>center</b></i> is obtained through the employeeSession.
' Also see: <i>CoordinatorLogin_SD</i>
    end note

    |||

    UI -> CTRL ** : create(company, center)
    activate CTRL
      CTRL -> COMPANY : snsUserStore = getSNSUserStore()
      activate COMPANY
      deactivate COMPANY
    deactivate CTRL
    
    COORDINATOR <-- UI : asks to type the file path
  deactivate UI

  COORDINATOR -> UI : types the file path
  activate UI

    ' read data

    UI -> CTRL : read(filepath)
    activate CTRL
      CTRL -> CSVREADER ** : create(filepath)
    deactivate CTRL

    ' process data

    ' convert to dto and send it to ui

    COORDINATOR <-- UI : shows the data
  deactivate UI
deactivate COORDINATOR
@enduml
